<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Arada Bingo Admin Panel</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
    h1 { color: #333; }
    .deposit { background: white; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
    button { margin-right: 10px; }
  </style>
</head>
<body>
  <h1>Admin Panel</h1>
  <div id="stats"></div>
  <h2>Pending Deposits</h2>
  <div id="deposits"></div>

  <script>
    const ADMIN_TOKEN = 'your-secret-token'; // Replace with your actual token

    async function loadStats() {
      const res = await fetch('/api/stats', {
        headers: { 'x-admin-token': ADMIN_TOKEN }
      });
      const data = await res.json();
      document.getElementById('stats').innerHTML = `
        <p>Total Players: ${data.totalPlayers}</p>
        <p>Total Deposits: ${data.totalDeposits}</p>
        <p>Total Payouts: ${data.totalPayouts}</p>
      `;
    }

    async function loadDeposits() {
      const res = await fetch('/api/deposit/all', {
        headers: { 'x-admin-token': ADMIN_TOKEN }
      });
      const data = await res.json();
      const container = document.getElementById('deposits');
      container.innerHTML = '';
      data.deposits.forEach(dep => {
        if (dep.status !== 'pending') return;
        const div = document.createElement('div');
        div.className = 'deposit';
        div.innerHTML = `
          <p><strong>${dep.telegramId}</strong> â€” ${dep.amount} coins</p>
          <img src="${dep.screenshot}" alt="screenshot" width="200" /><br/>
          <button onclick="approve('${dep._id}')">Approve</button>
          <button onclick="reject('${dep._id}')">Reject</button>
        `;
        container.appendChild(div);
      });
    }

    async function approve(id) {
      await fetch(`/api/admin/approve/${id}`, {
        method: 'POST',
        headers: { 'x-admin-token': ADMIN_TOKEN }
      });
      loadDeposits();
    }

    async function reject(id) {
      await fetch(`/api/admin/reject/${id}`, {
        method: 'POST',
        headers: { 'x-admin-token': ADMIN_TOKEN }
      });
      loadDeposits();
    }

    loadStats();
    loadDeposits();
  </script>
</body>
</html>
